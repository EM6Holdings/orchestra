!function(){"use strict";var t=angular.module("orchestra.project_management.services");t.factory("axis",["dataService","visUtils",function(t,e){return{draw:function(){if(e.parentContainer.select(".x.axis").style("opacity",0),t.timeSortedSlugs.length){var a=t.data.tasks[t.timeSortedSlugs[0]],i=new Date(a.start_datetime),r=t.timeSortedSlugs.map(function(e){return t.taskEnd(t.taskFromKey(e))}),n=i;r.forEach(function(t){var e=new Date(t);e>i&&(n=e)});var s=36e5,c=Math.ceil((n-i)/s);n=new Date(i.getTime()+c*s);var o=d3.range(0,c+1).map(function(t){return new Date(i.getTime()+t*s)});this.timeScale=d3.time.scale().domain([i,n]).range([0,e.params.scaleWidth]);var l,m=d3.svg.axis().scale(this.timeScale).tickSize(10),u=5;if(this.relativeTime)m.tickValues(o).tickFormat(function(t,e){return o.length<u||e%u===0?(t-i)/s:void 0}),l="Time (hours)";else{m.ticks(d3.time.hour,1);var d=this.timeScale.tickFormat();m.tickFormat(function(t,e){return e%u===0?d(t):""}),l="Time (local)"}e.parentContainer.select(".x.label").text(l).style("right",e.getSvgWidth()+5+"px"),e.parentContainer.select(".x.axis").transition().call(m),e.parentContainer.select(".x.axis").style("opacity",1).attr("width",e.getSvgWidth())}},getOffset:function(t){return this.timeScale(new Date(t))}}}])}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm9yY2hlc3RyYS9wcm9qZWN0X21hbmFnZW1lbnQvanMvYXhpcy5qcyJdLCJuYW1lcyI6WyJzZXJ2aWNlTW9kdWxlIiwiYW5ndWxhciIsIm1vZHVsZSIsImZhY3RvcnkiLCJkYXRhU2VydmljZSIsInZpc1V0aWxzIiwiZHJhdyIsInBhcmVudENvbnRhaW5lciIsInNlbGVjdCIsInN0eWxlIiwidGltZVNvcnRlZFNsdWdzIiwibGVuZ3RoIiwiZmlyc3RUYXNrIiwiZGF0YSIsInRhc2tzIiwibWluRGF0ZXRpbWUiLCJEYXRlIiwic3RhcnRfZGF0ZXRpbWUiLCJ0YXNrRW5kVGltZXMiLCJtYXAiLCJzbHVnIiwidGFza0VuZCIsInRhc2tGcm9tS2V5IiwibWF4RGF0ZXRpbWUiLCJmb3JFYWNoIiwiZGF0ZXRpbWVfc3RyaW5nIiwibmV4dERhdGV0aW1lIiwiaG91ckluTWlsbGlzZWNvbmRzIiwibnVtSG91cnMiLCJNYXRoIiwiY2VpbCIsImdldFRpbWUiLCJob3VyVGlja3MiLCJkMyIsInJhbmdlIiwiaG91ckluZGV4IiwidGhpcyIsInRpbWVTY2FsZSIsInRpbWUiLCJzY2FsZSIsImRvbWFpbiIsInBhcmFtcyIsInNjYWxlV2lkdGgiLCJ4TGFiZWxUZXh0IiwieEF4aXMiLCJzdmciLCJheGlzIiwidGlja1NpemUiLCJ0aWNrU3ByZWFkIiwicmVsYXRpdmVUaW1lIiwidGlja1ZhbHVlcyIsInRpY2tGb3JtYXQiLCJkIiwiaSIsInRpY2tzIiwiaG91ciIsImRlZmF1bHRGb3JtYXQiLCJ0ZXh0IiwiZ2V0U3ZnV2lkdGgiLCJ0cmFuc2l0aW9uIiwiY2FsbCIsImF0dHIiLCJnZXRPZmZzZXQiLCJkYXRldGltZSJdLCJtYXBwaW5ncyI6IkNBQUEsV0FDRSxZQUVBLElBQUlBLEdBQWdCQyxRQUFRQyxPQUFPLHdDQUVuQ0YsR0FBY0csUUFBUSxRQUFBLGNBQUEsV0FBUSxTQUFTQyxFQUFhQyxHQUlsRCxPQUNFQyxLQUFNLFdBS0osR0FEQUQsRUFBU0UsZ0JBQWdCQyxPQUFPLFdBQVdDLE1BQU0sVUFBVyxHQUN2REwsRUFBWU0sZ0JBQWdCQyxPQUFqQyxDQUdBLEdBQUlDLEdBQVlSLEVBQVlTLEtBQUtDLE1BQU1WLEVBQVlNLGdCQUFnQixJQUMvREssRUFBYyxHQUFJQyxNQUFLSixFQUFVSyxnQkFDakNDLEVBQWVkLEVBQVlNLGdCQUFnQlMsSUFBSSxTQUFTQyxHQUMxRCxNQUFPaEIsR0FBWWlCLFFBQVFqQixFQUFZa0IsWUFBWUYsTUFHakRHLEVBQWNSLENBQ2xCRyxHQUFhTSxRQUFRLFNBQVNDLEdBQzVCLEdBQUlDLEdBQWUsR0FBSVYsTUFBS1MsRUFDeEJDLEdBQWVYLElBQ2pCUSxFQUFjRyxJQUlsQixJQUFJQyxHQUFxQixLQUNyQkMsRUFBV0MsS0FBS0MsTUFBTVAsRUFBY1IsR0FBZVksRUFDdkRKLEdBQWMsR0FBSVAsTUFBS0QsRUFBWWdCLFVBQVlILEVBQVdELEVBRTFELElBQUlLLEdBQVlDLEdBQUdDLE1BQU0sRUFBR04sRUFBVyxHQUFHVCxJQUFJLFNBQVNnQixHQUNyRCxNQUFPLElBQUluQixNQUFLRCxFQUFZZ0IsVUFBWUksRUFBWVIsSUFHdERTLE1BQUtDLFVBQVlKLEdBQUdLLEtBQUtDLFFBQ3RCQyxRQUFRekIsRUFBYVEsSUFDckJXLE9BQU8sRUFBRzdCLEVBQVNvQyxPQUFPQyxZQUU3QixJQUtJQyxHQUxBQyxFQUFRWCxHQUFHWSxJQUFJQyxPQUNoQlAsTUFBTUgsS0FBS0MsV0FDWFUsU0FBUyxJQUVSQyxFQUFhLENBRWpCLElBQUlaLEtBQUthLGFBQ1BMLEVBQU1NLFdBQVdsQixHQUNkbUIsV0FBVyxTQUFTQyxFQUFHQyxHQUN0QixNQUFJckIsR0FBVXJCLE9BQVNxQyxHQUFjSyxFQUFJTCxJQUFlLEdBQzlDSSxFQUFJckMsR0FBZVksRUFEN0IsU0FJSmdCLEVBQWEsbUJBQ1IsQ0FDTEMsRUFBTVUsTUFBTXJCLEdBQUdLLEtBQUtpQixLQUFNLEVBQzFCLElBQUlDLEdBQWdCcEIsS0FBS0MsVUFBVWMsWUFDbkNQLEdBQU1PLFdBQVcsU0FBU0MsRUFBR0MsR0FDM0IsTUFBT0EsR0FBSUwsSUFBZSxFQUFJUSxFQUFjSixHQUFLLEtBRW5EVCxFQUFhLGVBR2Z0QyxFQUFTRSxnQkFBZ0JDLE9BQU8sWUFDN0JpRCxLQUFLZCxHQUNMbEMsTUFBTSxRQUFTSixFQUFTcUQsY0FBZ0IsRUFBSSxNQUUvQ3JELEVBQVNFLGdCQUFnQkMsT0FBTyxXQUFXbUQsYUFBYUMsS0FBS2hCLEdBQzdEdkMsRUFBU0UsZ0JBQWdCQyxPQUFPLFdBQzdCQyxNQUFNLFVBQVcsR0FDakJvRCxLQUFLLFFBQVN4RCxFQUFTcUQsaUJBRTVCSSxVQUFXLFNBQVNDLEdBSWxCLE1BQU8zQixNQUFLQyxVQUFVLEdBQUlyQixNQUFLK0MiLCJmaWxlIjoib3JjaGVzdHJhL3Byb2plY3RfbWFuYWdlbWVudC9qcy9heGlzLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIHZhciBzZXJ2aWNlTW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ29yY2hlc3RyYS5wcm9qZWN0X21hbmFnZW1lbnQuc2VydmljZXMnKTtcblxuICBzZXJ2aWNlTW9kdWxlLmZhY3RvcnkoJ2F4aXMnLCBmdW5jdGlvbihkYXRhU2VydmljZSwgdmlzVXRpbHMpIHtcbiAgICAvKipcbiAgICAgKiBTZXJ2aWNlIHRvIGhhbmRsZSBhbGlnbmluZyB2aXN1YWxpemF0aW9uIGVsZW1lbnRzIHRvIGEgY29tbW9uIHRpbWUgYXhpcy5cbiAgICAgKi9cbiAgICByZXR1cm4ge1xuICAgICAgZHJhdzogZnVuY3Rpb24oKSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBEcmF3cy91cGRhdGVzIGF4aXMgd2l0aCBib3RoIHJlbGF0aXZlIGFuZCBsb2NhbCB0aW1lIHNjYWxlcy5cbiAgICAgICAgICovXG4gICAgICAgIHZpc1V0aWxzLnBhcmVudENvbnRhaW5lci5zZWxlY3QoJy54LmF4aXMnKS5zdHlsZSgnb3BhY2l0eScsIDApO1xuICAgICAgICBpZiAoIWRhdGFTZXJ2aWNlLnRpbWVTb3J0ZWRTbHVncy5sZW5ndGgpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGZpcnN0VGFzayA9IGRhdGFTZXJ2aWNlLmRhdGEudGFza3NbZGF0YVNlcnZpY2UudGltZVNvcnRlZFNsdWdzWzBdXTtcbiAgICAgICAgdmFyIG1pbkRhdGV0aW1lID0gbmV3IERhdGUoZmlyc3RUYXNrLnN0YXJ0X2RhdGV0aW1lKTtcbiAgICAgICAgdmFyIHRhc2tFbmRUaW1lcyA9IGRhdGFTZXJ2aWNlLnRpbWVTb3J0ZWRTbHVncy5tYXAoZnVuY3Rpb24oc2x1Zykge1xuICAgICAgICAgIHJldHVybiBkYXRhU2VydmljZS50YXNrRW5kKGRhdGFTZXJ2aWNlLnRhc2tGcm9tS2V5KHNsdWcpKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdmFyIG1heERhdGV0aW1lID0gbWluRGF0ZXRpbWU7XG4gICAgICAgIHRhc2tFbmRUaW1lcy5mb3JFYWNoKGZ1bmN0aW9uKGRhdGV0aW1lX3N0cmluZykge1xuICAgICAgICAgIHZhciBuZXh0RGF0ZXRpbWUgPSBuZXcgRGF0ZShkYXRldGltZV9zdHJpbmcpO1xuICAgICAgICAgIGlmIChuZXh0RGF0ZXRpbWUgPiBtaW5EYXRldGltZSkge1xuICAgICAgICAgICAgbWF4RGF0ZXRpbWUgPSBuZXh0RGF0ZXRpbWU7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICB2YXIgaG91ckluTWlsbGlzZWNvbmRzID0gNjAgKiA2MCAqIDEwMDA7XG4gICAgICAgIHZhciBudW1Ib3VycyA9IE1hdGguY2VpbCgobWF4RGF0ZXRpbWUgLSBtaW5EYXRldGltZSkgLyBob3VySW5NaWxsaXNlY29uZHMpO1xuICAgICAgICBtYXhEYXRldGltZSA9IG5ldyBEYXRlKG1pbkRhdGV0aW1lLmdldFRpbWUoKSArIG51bUhvdXJzICogaG91ckluTWlsbGlzZWNvbmRzKTtcblxuICAgICAgICB2YXIgaG91clRpY2tzID0gZDMucmFuZ2UoMCwgbnVtSG91cnMgKyAxKS5tYXAoZnVuY3Rpb24oaG91ckluZGV4KSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBEYXRlKG1pbkRhdGV0aW1lLmdldFRpbWUoKSArIGhvdXJJbmRleCAqIGhvdXJJbk1pbGxpc2Vjb25kcyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMudGltZVNjYWxlID0gZDMudGltZS5zY2FsZSgpXG4gICAgICAgICAgLmRvbWFpbihbbWluRGF0ZXRpbWUsIG1heERhdGV0aW1lXSlcbiAgICAgICAgICAucmFuZ2UoWzAsIHZpc1V0aWxzLnBhcmFtcy5zY2FsZVdpZHRoXSk7XG5cbiAgICAgICAgdmFyIHhBeGlzID0gZDMuc3ZnLmF4aXMoKVxuICAgICAgICAgIC5zY2FsZSh0aGlzLnRpbWVTY2FsZSlcbiAgICAgICAgICAudGlja1NpemUoMTApO1xuXG4gICAgICAgIHZhciB0aWNrU3ByZWFkID0gNTtcbiAgICAgICAgdmFyIHhMYWJlbFRleHQ7XG4gICAgICAgIGlmICh0aGlzLnJlbGF0aXZlVGltZSkge1xuICAgICAgICAgIHhBeGlzLnRpY2tWYWx1ZXMoaG91clRpY2tzKVxuICAgICAgICAgICAgLnRpY2tGb3JtYXQoZnVuY3Rpb24oZCwgaSkge1xuICAgICAgICAgICAgICBpZiAoaG91clRpY2tzLmxlbmd0aCA8IHRpY2tTcHJlYWQgfHwgaSAlIHRpY2tTcHJlYWQgPT09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKGQgLSBtaW5EYXRldGltZSkgLyBob3VySW5NaWxsaXNlY29uZHM7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIHhMYWJlbFRleHQgPSAnVGltZSAoaG91cnMpJztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB4QXhpcy50aWNrcyhkMy50aW1lLmhvdXIsIDEpO1xuICAgICAgICAgIHZhciBkZWZhdWx0Rm9ybWF0ID0gdGhpcy50aW1lU2NhbGUudGlja0Zvcm1hdCgpO1xuICAgICAgICAgIHhBeGlzLnRpY2tGb3JtYXQoZnVuY3Rpb24oZCwgaSkge1xuICAgICAgICAgICAgcmV0dXJuIGkgJSB0aWNrU3ByZWFkID09PSAwID8gZGVmYXVsdEZvcm1hdChkKSA6ICcnO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIHhMYWJlbFRleHQgPSAnVGltZSAobG9jYWwpJztcbiAgICAgICAgfVxuXG4gICAgICAgIHZpc1V0aWxzLnBhcmVudENvbnRhaW5lci5zZWxlY3QoJy54LmxhYmVsJylcbiAgICAgICAgICAudGV4dCh4TGFiZWxUZXh0KVxuICAgICAgICAgIC5zdHlsZSgncmlnaHQnLCB2aXNVdGlscy5nZXRTdmdXaWR0aCgpICsgNSArICdweCcpO1xuXG4gICAgICAgIHZpc1V0aWxzLnBhcmVudENvbnRhaW5lci5zZWxlY3QoJy54LmF4aXMnKS50cmFuc2l0aW9uKCkuY2FsbCh4QXhpcyk7XG4gICAgICAgIHZpc1V0aWxzLnBhcmVudENvbnRhaW5lci5zZWxlY3QoJy54LmF4aXMnKVxuICAgICAgICAgIC5zdHlsZSgnb3BhY2l0eScsIDEpXG4gICAgICAgICAgLmF0dHIoJ3dpZHRoJywgdmlzVXRpbHMuZ2V0U3ZnV2lkdGgoKSk7XG4gICAgICB9LFxuICAgICAgZ2V0T2Zmc2V0OiBmdW5jdGlvbihkYXRldGltZSkge1xuICAgICAgICAvKipcbiAgICAgICAgICogQ2FsY3VsYXRlcyB0aGUgYXhpcyBvZmZzZXQgZm9yIGEgZ2l2ZW4gZGF0ZXRpbWUgc3RyaW5nLlxuICAgICAgICAgKi9cbiAgICAgICAgcmV0dXJuIHRoaXMudGltZVNjYWxlKG5ldyBEYXRlKGRhdGV0aW1lKSk7XG4gICAgICB9XG4gICAgfTtcbiAgfSk7XG59KSgpO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
